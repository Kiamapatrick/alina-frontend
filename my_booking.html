<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>My Bookings ‚Äî Alina906Vibes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Sora:wght@400;600;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="css/navbar.css" />
    <link rel="stylesheet" href="css/avatar-dropdown.css" />
    <link rel="stylesheet" href="css/my_booking.css" />
</head>

<body>

    <!-- Status Toast -->
    <div id="pageStatus"></div>

    <!-- ‚ïê‚ïê‚ïê Navbar ‚ïê‚ïê‚ïê -->
    <nav id="mainNavbar" class="alina-navbar">
        <div class="navbar-inner">
            <div class="navbar-row1">
                <a class="navbar-logo" href="index.html">Alina<span>906</span>Vibes</a>
                <ul class="navbar-links">
                    <li><a href="index.html" data-page="index">Home</a></li>
                    <li><a href="about.html" data-page="about">About</a></li>
                    <li><a href="contact.html" data-page="contact">Contact</a></li>
                </ul>
            </div>
            <div class="navbar-row2">
                <div class="navbar-actions">
                    <span class="nav-welcome" id="navWelcome"></span>
                    <a id="loginLink" href="login.html" class="nav-btn nav-btn-outline">Sign In</a>
                    <a id="signupLink" href="signup.html" class="nav-btn nav-btn-solid">Sign Up</a>
                    <div class="wallet-area" id="navWalletWrapper">
                        <button id="connectWallet" class="wallet-connect-btn">
                            <span class="wallet-icon">ü¶ä</span> Connect Wallet
                        </button>
                        <div id="walletInfoRow" class="wallet-connected" style="display:none;">
                            <span class="wallet-status-dot"></span>
                            <span id="walletAddress" class="wallet-addr">‚Äî</span>
                            <button id="disconnectWallet" class="wallet-disconnect-btn">‚úï</button>
                        </div>
                    </div>
                    <div id="avatarDropdown" class="avatar-area" style="display:none;">
                        <button class="avatar-btn" id="avatarToggle" aria-haspopup="true" aria-expanded="false"
                            aria-label="Account menu">
                            <span class="avatar-initials" id="avatarInitials">?</span>
                            <span class="avatar-name" id="avatarName">User</span>
                            <!-- JS appends .avatar-caret SVG and .avatar-notif-dot here -->
                        </button>
                        <div class="avatar-menu" id="avatarMenu" role="menu">
                            <a href="my_booking.html" class="avatar-menu-item">üìã My Bookings</a>
                            <a href="dashboard.html" class="avatar-menu-item">üë§ Account</a>
                            <div class="avatar-menu-item kyc-status-item">
                                üõ°Ô∏è KYC Status <span id="kycBadge" class="kyc-badge">‚Äî</span>
                            </div>
                            <hr class="avatar-menu-divider">
                            <button id="logoutBtn" class="avatar-menu-item logout-item">üö™ Log Out</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê -->
    <section class="bookings-hero">
        <div class="grain"></div>
        <div class="hero-inner">
            <div class="hero-text">
                <div class="eyebrow">Dashboard</div>
                <h1>My <span>Bookings</span></h1>
                <p>Manage your stays, track upcoming reservations, and review your booking history ‚Äî all in one place.
                </p>
            </div>
            <div class="hero-stats" id="heroStats">
                <div class="stat-pill">
                    <span class="stat-num" id="statTotal">‚Äî</span>
                    <span class="stat-lbl">Total</span>
                </div>
                <div class="stat-pill">
                    <span class="stat-num" id="statUpcoming">‚Äî</span>
                    <span class="stat-lbl">Upcoming</span>
                </div>
                <div class="stat-pill">
                    <span class="stat-num" id="statCompleted">‚Äî</span>
                    <span class="stat-lbl">Completed</span>
                </div>
            </div>
        </div>
    </section>

    <!-- ‚ïê‚ïê‚ïê FILTER BAR ‚ïê‚ïê‚ïê -->
    <div class="controls-bar">
        <div class="controls-inner">
            <div class="filter-tabs" id="filterTabs">
                <button class="filter-tab active" data-filter="all">All Bookings</button>
                <button class="filter-tab" data-filter="upcoming">Upcoming</button>
                <button class="filter-tab" data-filter="active">Active</button>
                <button class="filter-tab" data-filter="completed">Completed</button>
                <button class="filter-tab" data-filter="cancelled">Cancelled</button>
            </div>
            <div class="search-wrap">
                <span class="search-icon">üîç</span>
                <input type="text" id="bookingSearch" placeholder="Search property‚Ä¶" />
            </div>
            <select class="sort-select" id="sortSelect">
                <option value="date-desc">Newest First</option>
                <option value="date-asc">Oldest First</option>
                <option value="checkin">Check-in Date</option>
                <option value="price-desc">Price ‚Üì</option>
                <option value="price-asc">Price ‚Üë</option>
            </select>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê MAIN CONTENT ‚ïê‚ïê‚ïê -->
    <main class="page-content">
        <div class="section-heading" id="sectionHeading" style="display:none;">
            <h2 id="sectionTitle">All Bookings</h2>
            <span class="count-badge" id="resultCount">0 results</span>
        </div>

        <!-- Skeleton -->
        <div id="skeletonLoader" class="skeleton-grid">
            <div class="skeleton-card">
                <div class="skeleton-img"></div>
                <div class="skeleton-body">
                    <div class="skel-line medium"></div>
                    <div class="skel-line short"></div>
                    <div class="skel-line medium" style="margin-top:14px;"></div>
                    <div class="skel-line short"></div>
                </div>
            </div>
            <div class="skeleton-card">
                <div class="skeleton-img"></div>
                <div class="skeleton-body">
                    <div class="skel-line medium"></div>
                    <div class="skel-line short"></div>
                    <div class="skel-line medium" style="margin-top:14px;"></div>
                    <div class="skel-line short"></div>
                </div>
            </div>
            <div class="skeleton-card">
                <div class="skeleton-img"></div>
                <div class="skeleton-body">
                    <div class="skel-line medium"></div>
                    <div class="skel-line short"></div>
                    <div class="skel-line medium" style="margin-top:14px;"></div>
                    <div class="skel-line short"></div>
                </div>
            </div>
        </div>

        <!-- Login prompt -->
        <div id="loginPrompt" class="login-prompt" style="display:none;">
            <span class="lock-icon">üîê</span>
            <h3>Sign in to view your bookings</h3>
            <p>You need to be logged in to see your reservation history.</p>
            <a href="login.html" class="btn-browse">Sign In ‚Üí</a>
        </div>

        <!-- Bookings grid -->
        <div id="bookingsGrid" style="display:none;"></div>

        <!-- Empty state -->
        <div id="emptyState" class="empty-state" style="display:none;">
            <div class="empty-icon-wrap">üè°</div>
            <h3>No bookings found</h3>
            <p id="emptyMsg">You haven't made any reservations yet. Start exploring our units!</p>
            <a href="index.html" class="btn-browse">Browse Properties ‚Üí</a>
        </div>
    </main>

    <!-- ‚ïê‚ïê‚ïê DETAIL MODAL ‚ïê‚ïê‚ïê -->
    <div class="detail-modal-overlay" id="detailModalOverlay">
        <div class="detail-modal" id="detailModal">
            <div id="modalImgWrap"></div>
            <div class="modal-body-wrap">
                <div class="modal-header-row">
                    <div class="modal-title" id="modalTitle">‚Äî</div>
                    <button class="modal-close" id="modalClose">‚úï</button>
                </div>
                <div id="modalBadgeRow" class="badge-row" style="margin-bottom:16px;"></div>
                <div class="modal-details-grid" id="modalDetailsGrid"></div>
                <div class="modal-actions" id="modalActions"></div>
            </div>
        </div>
    </div>

    <footer class="site-footer">¬© 2025 Alina906Vibes ‚Äî Built on Polygon Amoy Testnet</footer>

    <!-- ‚îÄ‚îÄ‚îÄ SCRIPTS ‚îÄ‚îÄ‚îÄ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
    <script src="js/nav.js"></script>

    <!--
      balance-payment.js is an ES module so we import it as type="module".
      Everything else below is classic script so it runs after the module is parsed.
    -->
    <script type="module">
        // ‚îÄ‚îÄ Import balance payment module ‚îÄ‚îÄ
        import { openBalancePayment, bp_checkPaystackCallback } from './js/balance-payment.js';

        // Expose to classic-script scope so card buttons can call it
        window._openBalancePayment = openBalancePayment;

        // When a payment completes, refresh the bookings list
        document.addEventListener('bp:payment-complete', () => {
            init();
        });

        // Check if we're returning from a Paystack balance redirect
        document.addEventListener('DOMContentLoaded', () => {
            bp_checkPaystackCallback();
        });
    </script>

    <script src="js/my_booking.js"></script>

</body>

</html>